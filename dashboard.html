<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cantiere | Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <style>
        :root { --cantiere-gold: #ffc107; --cantiere-dark: #121212; }
        body { background-color: var(--cantiere-dark); color: #fff; }
        .navbar { background: #000; border-bottom: 2px solid var(--cantiere-gold); }
        .nav-link { color: #fff !important; font-weight: bold; margin-right: 15px; }
        .maga-card { background: #1e1e1e; border: 1px solid #333; border-radius: 15px; padding: 2rem; text-align: center; cursor: pointer; transition: 0.3s; }
        .maga-card:hover { border-color: var(--cantiere-gold); transform: translateY(-5px); }
        .maga-icon { font-size: 3rem; color: var(--cantiere-gold); }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg p-3">
        <div class="container-fluid">
            <span class="navbar-brand fw-bold text-warning">CANTIERE</span>
            <div class="navbar-nav">
                <a class="nav-link" href="movimenti.html">MOVIMENTI</a>
                <a class="nav-link" href="prodotti.html">PRODOTTI</a>
                <a class="nav-link" href="storico.html">STORICO</a>
                <button class="btn btn-outline-danger btn-sm" onclick="localStorage.clear(); location.href='index.html'">LOGOUT</button>
            </div>
        </div>
    </nav>

    <div class="container mt-5">
        <h2 class="fw-bold mb-4">SITUAZIONE MAGAZZINI</h2>
        <div class="row g-4" id="maga-list"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        if(!localStorage.getItem('cantiere_user')) location.href='index.html';
        const _supabase = supabase.createClient("https://jkekmxhrwwidkfoizhde.supabase.co", "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImprZWtteGhyd3dpZGtmb2l6aGRlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE0NjEwMTcsImV4cCI6MjA4NzAzNzAxN30.U_XxfpAR76Y7bhB_DdUu2CMeuIarR4158dgwITFRWAg");

        async function carica() {
            const { data } = await _supabase.from('magazzini').select('*').order('nome');
            document.getElementById('maga-list').innerHTML = data.map(m => `
                <div class="col-md-4">
                    <div class="maga-card" onclick="location.href='dettaglio_magazzino.html?id=${m.id}&nome=${m.nome}'">
                        <div class="maga-icon"><i class="bi bi-house-door-fill"></i></div>
                        <h4 class="fw-bold mt-2">${m.nome}</h4>
                        <p class="text-secondary small">Clicca per visualizzare scorte</p>
                    </div>
                </div>
            `).join('');
        }
        carica();
    </script>
</body>
</html>
